<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Signup - KidsLearn</title>
  <style>
    body { font-family: Arial, Helvetica, sans-serif; padding: 20px; }
    form { max-width: 360px; margin: 0 auto; display:flex; flex-direction:column; gap:10px; }
    input { padding:8px; font-size:14px; }
    button { padding:10px; background:#4f46e5; color:#fff; border:none; cursor:pointer; }
    .msg { text-align:center; margin-top:12px; color:#555; }
  </style>
</head>
<body>
  <h2 style="text-align:center">Signup</h2>

  <form id="signupForm" autocomplete="off">
    <input type="text" name="name" placeholder="Username (unique)" required />
    <input type="email" name="email" placeholder="Email" required />
    <input type="password" name="password" placeholder="Password" required />
    <button type="submit">Signup</button>
  </form>

  <p class="msg">Already have an account? <a href="login.html">Login</a></p>

  <script>
    // Client-side signup script - posts to your backend and redirects to login on success.
    (function () {
      const form = document.getElementById('signupForm');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const formData = new FormData(form);
        const payload = {
          name: formData.get('name').trim(),
          email: formData.get('email').trim(),
          password: formData.get('password')
        };

        try {
          const res = await fetch('/api/users/signup', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          });

          const result = await res.json().catch(() => ({}));

          if (res.ok) {
            alert(result.message || 'Registered successfully. Please login.');
            // Per your requested flow: go to login page after registering
            window.location.href = 'login.html';
          } else {
            // backend may send { message: '...' } or text
            const msg = result.message || (await res.text().catch(() => 'Signup failed'));
            alert(msg);
          }
        } catch (err) {
          console.error('Signup error', err);
          alert('Signup failed â€” check console for details');
        }
      });
    })();
  </script>
</body>
</html>
